Sherpa location
/afs/cern.ch/cms/sw/slc5_ia32_gcc434/external/sherpa/1.2.0-cms2

===================================================================
====================== STATUS =====================================
===================================================================
lxb8840
Wg_0j    step1 in 19m, step2 in 5s, step3 in 6m*
Wg_0j1   step1 in 18m, step2 in 5s, step3 in 6m*
Wg_0j2   step1 in 3h32m, step2 in 20s, step3 in 8m**
Wg_0j3   step1 killed
Wg_0j4   step1 killed

lxb8860
ZgNoTau_0j  step1 in 9m, step2 in 4s, step3 in 18s
ZgNoTau_0j1 step1 in 2h40m, step2 in 6s, step3 crashed after 22m (event 16)
            w/ mass(ll)=10..50, ee only: step1 in 12m22, step3 in 6m/20s
            w/ mass(ll)=1..7000: step1 in 22m but running again, step3 in 7m
ZgNoTau_0j2 step1 killed
ZgNoTau_0j3 step1 killed
ZgNoTau_0j4 step1 killed
ZgMu_0j2    step1 in 24h
ZgMu_0j3    step1 killed
ZgMu_0j4    step1 killed


*100 evts, it can be repeated in 23s(!)
**100 evts, repeated runs in 126s

Running on the batch
lxplus313: /afs/cern.ch/cms/cit/veverka/zgamma/Sherpa/CMSSW_3_5_4/src/Sherpa/Common/test [614]$ python launchBatchJobs.sh
bsub -q 1nh80 /afs/cern.ch/cms/cit/veverka/zgamma/Sherpa/CMSSW_3_5_4/src/Sherpa/Common/test/batchJob.sh WgEle_0j
bsub -q 1nh80 /afs/cern.ch/cms/cit/veverka/zgamma/Sherpa/CMSSW_3_5_4/src/Sherpa/Common/test/batchJob.sh WgMu_0j
lxplus313: /afs/cern.ch/cms/cit/veverka/zgamma/Sherpa/CMSSW_3_5_4/src/Sherpa/Common/test [615]$ python launchBatchJobs.sh | sh
Job <64747003> is submitted to queue <1nh80>.
Job <64747004> is submitted to queue <1nh80>.

Wgamma Sherpacks v2
lxplus308: /afs/cern.ch/cms/cit/veverka/vgamma/sherpa/CMSSW_3_5_8/src/Sherpa/Common/test [1061]$ python submitBuildSherpack.py
bsub -q 1nh80 sh /afs/cern.ch/cms/cit/veverka/vgamma/sherpa/CMSSW_3_5_8/src/Sherpa/Common/test/buildSherpack.sh WgEle_0j
bsub -q 1nh80 sh /afs/cern.ch/cms/cit/veverka/vgamma/sherpa/CMSSW_3_5_8/src/Sherpa/Common/test/buildSherpack.sh WgEle_0j1
bsub -q 1nw80 sh /afs/cern.ch/cms/cit/veverka/vgamma/sherpa/CMSSW_3_5_8/src/Sherpa/Common/test/buildSherpack.sh WgEle_0j2
bsub -q   2nw sh /afs/cern.ch/cms/cit/veverka/vgamma/sherpa/CMSSW_3_5_8/src/Sherpa/Common/test/buildSherpack.sh WgEle_0j3
bsub -q   2nw sh /afs/cern.ch/cms/cit/veverka/vgamma/sherpa/CMSSW_3_5_8/src/Sherpa/Common/test/buildSherpack.sh WgEle_0j4
bsub -q   2nw sh /afs/cern.ch/cms/cit/veverka/vgamma/sherpa/CMSSW_3_5_8/src/Sherpa/Common/test/buildSherpack.sh WgEle_0j5
bsub -q   2nw sh /afs/cern.ch/cms/cit/veverka/vgamma/sherpa/CMSSW_3_5_8/src/Sherpa/Common/test/buildSherpack.sh WgEle_0j6
bsub -q 1nh80 sh /afs/cern.ch/cms/cit/veverka/vgamma/sherpa/CMSSW_3_5_8/src/Sherpa/Common/test/buildSherpack.sh WgMu_0j
bsub -q 1nh80 sh /afs/cern.ch/cms/cit/veverka/vgamma/sherpa/CMSSW_3_5_8/src/Sherpa/Common/test/buildSherpack.sh WgMu_0j1
bsub -q 1nw80 sh /afs/cern.ch/cms/cit/veverka/vgamma/sherpa/CMSSW_3_5_8/src/Sherpa/Common/test/buildSherpack.sh WgMu_0j2
bsub -q   2nw sh /afs/cern.ch/cms/cit/veverka/vgamma/sherpa/CMSSW_3_5_8/src/Sherpa/Common/test/buildSherpack.sh WgMu_0j3
bsub -q   2nw sh /afs/cern.ch/cms/cit/veverka/vgamma/sherpa/CMSSW_3_5_8/src/Sherpa/Common/test/buildSherpack.sh WgMu_0j4
bsub -q   2nw sh /afs/cern.ch/cms/cit/veverka/vgamma/sherpa/CMSSW_3_5_8/src/Sherpa/Common/test/buildSherpack.sh WgMu_0j5
bsub -q   2nw sh /afs/cern.ch/cms/cit/veverka/vgamma/sherpa/CMSSW_3_5_8/src/Sherpa/Common/test/buildSherpack.sh WgMu_0j6
bsub -q 1nh80 sh /afs/cern.ch/cms/cit/veverka/vgamma/sherpa/CMSSW_3_5_8/src/Sherpa/Common/test/buildSherpack.sh WgTau_0j
bsub -q 1nh80 sh /afs/cern.ch/cms/cit/veverka/vgamma/sherpa/CMSSW_3_5_8/src/Sherpa/Common/test/buildSherpack.sh WgTau_0j1
bsub -q 1nw80 sh /afs/cern.ch/cms/cit/veverka/vgamma/sherpa/CMSSW_3_5_8/src/Sherpa/Common/test/buildSherpack.sh WgTau_0j2
bsub -q   2nw sh /afs/cern.ch/cms/cit/veverka/vgamma/sherpa/CMSSW_3_5_8/src/Sherpa/Common/test/buildSherpack.sh WgTau_0j3
bsub -q   2nw sh /afs/cern.ch/cms/cit/veverka/vgamma/sherpa/CMSSW_3_5_8/src/Sherpa/Common/test/buildSherpack.sh WgTau_0j4
bsub -q   2nw sh /afs/cern.ch/cms/cit/veverka/vgamma/sherpa/CMSSW_3_5_8/src/Sherpa/Common/test/buildSherpack.sh WgTau_0j5
bsub -q   2nw sh /afs/cern.ch/cms/cit/veverka/vgamma/sherpa/CMSSW_3_5_8/src/Sherpa/Common/test/buildSherpack.sh WgTau_0j6
lxplus308: /afs/cern.ch/cms/cit/veverka/vgamma/sherpa/CMSSW_3_5_8/src/Sherpa/Common/test [1062]$ python submitBuildSherpack.py | sh
Job <76159915> is submitted to queue <1nh80>.
Job <76159918> is submitted to queue <1nh80>.
Job <76159920> is submitted to queue <1nw80>.
Job <76159922> is submitted to queue <2nw>.
Job <76159924> is submitted to queue <2nw>.
Job <76159925> is submitted to queue <2nw>.
Job <76159930> is submitted to queue <2nw>.
Job <76159931> is submitted to queue <1nh80>.
Job <76159932> is submitted to queue <1nh80>.
Job <76159935> is submitted to queue <1nw80>.
Job <76159936> is submitted to queue <2nw>.
Job <76159938> is submitted to queue <2nw>.
Job <76159941> is submitted to queue <2nw>.
Job <76159945> is submitted to queue <2nw>.
Job <76159947> is submitted to queue <1nh80>.
Job <76159950> is submitted to queue <1nh80>.
Job <76159954> is submitted to queue <1nw80>.
Job <76159955> is submitted to queue <2nw>.
Job <76159959> is submitted to queue <2nw>.
Job <76159960> is submitted to queue <2nw>.
Job <76159961> is submitted to queue <2nw>.
lxplus308: /afs/cern.ch/cms/cit/veverka/vgamma/sherpa/CMSSW_3_5_8/src/Sherpa/Common/test [1063]$ date
Tue May 25 17:39:31 CEST 2010



===================================================================
====================== SHERPA 1.2.1 ===============================
===================================================================
ME+PS merging for prompt photon production
Merging of photons produced in real emission matrix elements with photons produced in the interleaved QCD+QED shower cascade has been implemented. Further details and a comparison to LEP and Tevatron data has been published in Phys. Rev. D 81, 034026 (2010).

ME+PS backward clustering improved
In the backward clustering step of the ME+PS merging algorithm we now take into account the shower weight for each potential branching history instead of simply choosing the most probable history.


Interface
https://twiki.cern.ch/twiki/bin/view/CMS/SherpaInterface
updated to 35X

After Sherpa has run, there will be a .tex-file located in the diagram information directory with the name <process>.tex. This has to be compiled by using latex <process>.tex, which produces a .mp-file. Enter mpost *.mp and again latex <process>.tex in order to produce the .dvi-file <process>.dvi containing the Feynman diagrams.


==============================================================
============= MINUTES FROM THE MEETING =======================
==============================================================

Minutes / Decisions
====================

Decided to request following samples:

1) Sherpa:
      - 1 M Wgamma (no ATGC)
      - 1M Zgamma  (no ATGC)

      This requires a patched release to include either:
       i) Use version 1.1.2 (currently in 35X) and additional EDFilter
          for DR Cut
          (note: this version has no aTGC and the ability for DR cut is switched off), or

            --> OK, we will not need a patch release on this. If you get it ready
            before early next week, we'll make it into 355, otherwise later into
            356. (Fabian Stoeckli)

      ii) Use version 1.2.1: means adding a different version of sherpa as external CMSSW
          library

     TODO: implement first i) (easier) but also ii) (want it on the long term)
     Timescale: ~ 1 week

     WHO:
        - Jan V. prepares the filter and config files for both Wgamma and Zgamma
        - Giulio: makes the request and get the config into a new patch release

    Number of events: 1M  (NO ATGC)

            --> It will not be a patch release. Please make sure you
                  - provide the EDFilter to us in time, so we can put it into CMSSW355
                  - the cfg does not need to be in a release at all (as any other cfg
            file), you'll need to commit it to Configuartion/GenProduction/python,
            as usual.


Kinematic cuts to be used:
================
- Et(Photon) > 5 GeV
- DR(Photon,Lepton)>0.3 (ONLY FOR Wgamma!)
- no eta cut!
- W decay channels: enu and munu
- Z decay channel: electrons, muons and neutrinos

QUESTIONS:
- Include W->tau (through tau -> e/mu, it will contribute slightly to the signal, it would
   be good to know how much)
- For Zgamma: split into 2 samples: one with Z->ee/mumu and the other Z->invisible?
   Otherwise, the sample will be dominated by neutrinos.



=====================================================================
======================== MADGRAPH CUTS ==============================
=====================================================================
So Zong-Kai and me will try to produce the LHE files using Madgraph v4.4.32.

The kinematic cuts are list as follow:

1) photon/lepton Pt > 5 GeV
2) jet Pt > 10 GeV
3) Mass(lepton+, lepton-) > 10 GeV
4) deltaR(photon, lepton) > 0.3 for "Wgamma and Zgamma"
5) deltaR(photon, jet) > 0.3
6) no eta cut on photon and lepton
7) the number of jets is 0~2 (mixing)
8) PDF is "cteq6l1"
9) decay channel: electron and muon for Wgamma; electron, muon, and neutrino for Zgamma

You can find the detail information in /afs/cern.ch/user/p/poter/public/Madgraph_Wgamma/run_card.dat.

Please check asap.

=====================================================================
============================ BAUR CUTS ==============================
=====================================================================
Hi All
Just to do a summary about the LO Zgamma Baur production:

1) 500k with SM couplings and Z->e,mu
  Kinematical cuts:
   --  Et(Photon) > 5 GeV
   --  Et(lepton) > 5 GeV
   --  no eta cut
   --  DR(Photon,Lepton)>0.3
   --  lepton+lepton_photon Invariant mass > 100 GeV
   --  Which PDF?

2) 500K with SM couplings and Z->invisible
   Kinematical cuts:
   --  Et(Photon) > 5 GeV

===================================================================
=================== SET THE RUN NUMBER ============================
===================================================================
from: http://home.fnal.gov/~duong/elog-2.7.8/logbooks/WorkLogBook/091217a.log
Date: Thu, 17 Dec 2009 16:08:01 -0600
Type: CMSSW utilities
Subject: No check duplicate
Attachment: 091217_160753_noCheckDuplicate_cfg.py
Encoding: plain
========================================
Manually generating the sample can't change the run number, so cmsRun will complain about duplicate of events:
> > "Duplicate Event found in entire set of input files"
> > "Both events were from run 1 and luminosity block 1"

Use this to change
$@MID@$: 8
Date: Thu, 17 Dec 2009 16:38:57 -0600
Type: CMSSW utilities
Subject: Note on Sherpa generation in 31X
Attachment: 091217_163724_condor_execute_gen.sh,091217_163847_sherpa_cfi.py
Encoding: plain
========================================
The generator configuration is sherpa_cfi.py under python dir of process generation dir. The main parameter is
"Run" under "SherpaParameters" block which is a cms.vstring.
Need to change the EVENTS and RANDOM_SEED.
See the attachment how to do that.
process.generator.SherpaParameters.Run[1] = ' EVENTS          = 10000'
process.generator.SherpaParameters.Run[6] = ' RANDOM_SEED     = ${RUNNUMBER}15733 ${RUNNUMBER}27621'



===================================================================
=================== BATCH JOBS STATUS =============================
===================================================================


=====================================================================
======================== SHERPA 1.2.1  ==============================
=====================================================================
Run card from Frank Siegert for testing interleaved QCD+QED
ME+PS merging

(run){
 NPHOTON:=2
 QCUT:=20
 FRAGMENTATION = Off
}(run)

(beam){
 BEAM_1          = 2212
 BEAM_ENERGY_1   = 3500.

 BEAM_2          = 2212
 BEAM_ENERGY_2   = 3500.
}(beam)

(processes){
 Process : 93 93 -> 11 -11 22{NPHOTON}
 CKKW sqr(QCUT/E_CMS)
 Enhance_Factor 100 {3}
 Enhance_Factor 10000 {4}
 End process
}(processes)

(selector){
 Mass 11 -11 66.0 116.0
}(selector)

(shower){
 CSS_EW_MODE = 1
}(shower)

(me){
 ME_SIGNAL_GENERATOR = Internal Comix
 EVENT_GENERATION_MODE = Weighted
 ME_QED = Off
}(me)

From chat on Skype:
...
[5/10/2010 3:48:33 PM] jan.veverka: i was wondering if i can specify
the process with the 22{1} instead of 99{1} to increase the efficiency
[5/10/2010 3:49:15 PM] jan.veverka: of photon production ...
[5/10/2010 3:50:29 PM] Frank Siegert: yes, absolutely. that's also
what i have been doing for my Zgamma studies at the moment. the only
problem is, that this will obviously only give you the QED
corrections, no QCD corrections. now i haven't tested it with
amegic/agc yet, so you might still run into problems that i haven't
seen. but one thing that you will definitely need, is to enable photon
emissions in the parton shower by setting "CSS_EW_SCHEME = 1" in the
(shower){ section
...
[5/10/2010 3:52:38 PM] Frank Siegert: as soon as you enable merging
(i.e. the 22{1} and the CKKW line) in the processes *and* have QED
splittings active in the shower, it will automatically cut on the
collinear divergences and let them be generated by the shower.
...
[5/10/2010 3:54:39 PM] Frank Siegert: just as a non-AGC example, here
is what i did for Zgamma:
(run){
 NPHOTON:=2
 QCUT:=20
 FRAGMENTATION = Off
}(run)

(beam){
 BEAM_1          = 2212
 BEAM_ENERGY_1   = 3500.

 BEAM_2          = 2212
 BEAM_ENERGY_2   = 3500.
}(beam)

(processes){
 Process : 93 93 -> 11 -11 22{NPHOTON}
 CKKW sqr(QCUT/E_CMS)
 Enhance_Factor 100 {3}
 Enhance_Factor 10000 {4}
 End process
}(processes)

(selector){
 Mass 11 -11 66.0 116.0
}(selector)

(shower){
 CSS_EW_MODE = 1
}(shower)

(me){
 ME_SIGNAL_GENERATOR = Internal Comix
 EVENT_GENERATION_MODE = Weighted
 ME_QED = Off
}(me)
[5/10/2010 3:55:01 PM] Frank Siegert: note that this generates
weighted/enhanced events though, don't know if that's what you want
...
[5/10/2010 3:58:24 PM] jan.veverka: so the "CKKW sqr(QCUT/E_CMS)"
regularizes the collinear divergence?
...
[5/10/2010 3:59:05 PM] Frank Siegert: yes. in my run card i used the
tag declaration QCUT:=20, but you can write it directly as CKKW
sqr(20/E_CMS)
...
[5/10/2010 4:00:22 PM] jan.veverka: does "CKKW sqrt(20/E_CMS)" roughly
correspond to "ET 22 20 9999"?
[5/10/2010 4:01:02 PM] Frank Siegert: roughly, yes. but in addition to
that it will correctly take care of the double counting with the
shower.
[5/10/2010 4:01:20 PM] jan.veverka: ok, that's exaclty what i want! :)
[5/10/2010 4:01:57 PM] jan.veverka: so i should remove all my photon
cuts from the selector section?
[5/10/2010 4:02:13 PM] Frank Siegert: yes, as long as your core
process doesn't have a photon
[5/10/2010 4:03:11 PM] jan.veverka: ok
[5/10/2010 4:03:14 PM] Frank Siegert: actually, one second, i think i
said something wrong.
[5/10/2010 4:03:59 PM] Frank Siegert: i think you can't do 22{1}
instead of 99{1} if you still want the shower to do qcd.
[5/10/2010 4:04:26 PM] Frank Siegert: i used this for testing pure QED
corrections, i.e. disabling higher-order QCD corrections in both ME
and shower.
[5/10/2010 4:06:04 PM] jan.veverka: basically i want "photon enriched"
V. how about
93 93 -> -11 11 22{1} 99{2} ?
[5/10/2010 4:07:35 PM] Frank Siegert: this has technical reasons,
namely that the shower will assume that the first emission has been
ME-corrected also for QCD and will not produce the corresponding
emissions, but veto the events above the cut.
[5/10/2010 4:08:22 PM] jan.veverka: suppose i add an extra filter
between sherpa and our full sim that requires
"ET 22 5 9999"
"DeltaR 90 22 0.3 9999"
where 22 is the leading prompt photon (both ME and PS origin)
[5/10/2010 4:08:24 PM] Frank Siegert: the solution (not in 1.2.1)
would be to treat the qed and qcd merging more separate than we
currently do. i think this is possible, we'll have to think about it.
[5/10/2010 4:08:56 PM] Frank Siegert: about your filter:
[5/10/2010 4:09:54 PM] Frank Siegert: of course you can filter
afterwards. the 99 sample is completely inclusive. the reason above is
really purely technical.
...
[5/10/2010 4:16:09 PM] Frank Siegert: btw... there is a lot of
obsolete stuff that you can remove from your run card. e.g. you should
definitely remove everything in (mi) except for MI_HANDLER=Amisic,
because it will destroy the default tune.
[5/10/2010 4:17:32 PM] jan.veverka: oh thanks!
[5/10/2010 4:17:36 PM] Frank Siegert: also you can remove the full
fragmentation, integration, model sections, as they are all at default
as far as i can see
[5/10/2010 4:18:12 PM] Frank Siegert: in isr you only need
 PDF_LIBRARY     = LHAPDFSherpa
 PDF_SET         = cteq6ll.LHpdf
[5/10/2010 4:18:32 PM] Frank Siegert: in beam only
 BEAM_1          = 2212
 BEAM_ENERGY_1   = 3500.

 BEAM_2          = 2212
 BEAM_ENERGY_2   = 3500.
[5/10/2010 4:19:41 PM] Frank Siegert: let me know if any of that
causes problems. but it's usually a good idea to only change the
relevant things in the run card, such that you don't overwrite any
default choices
[5/10/2010 4:20:19 PM] jan.veverka: sure
[5/10/2010 4:20:30 PM] jan.veverka: these were there for historical reasons
[5/10/2010 4:20:56 PM] Frank Siegert: now that i think of it: is there
any reason why you are using cteq6ll? maybe that's why you had
different mi settings, because our default MI tune goes with the
default PDF, which is cteq66m currently.
[5/10/2010 4:21:06 PM] jan.veverka: basically i took some "official"
cms run card for old 1.1.2 and kept everything that i could ...
[5/10/2010 4:21:16 PM] Frank Siegert: if there is no reason for it,
remove the isr section altogether
[5/10/2010 4:22:09 PM] jan.veverka: I have cteq6ll since it has been
used with other generators ...
[5/10/2010 4:22:37 PM] jan.veverka: but i will ask around to see if we
want to upgrade ...
[5/10/2010 4:22:50 PM] jan.veverka: these are great hints, thanks!
[5/10/2010 4:23:20 PM] Frank Siegert: i see. should be ok, as long as
you are not too sensitive to the underlying event (because that's
tuned with cteq66m and will be out-of-tune if you use cteq6ll). it's
not so much about "upgrading", it's more a choice. for pythia for
example you probably don't want to use cteq66m, at least the authors
dont recommend it i think.
..
[5/10/2010 4:30:21 PM] jan.veverka: one more question: how exactly do
i toggle between the YFS and PS?
is it
"CSS_EW_SCHEME = 1"?
[5/10/2010 4:30:47 PM] jan.veverka: or
(me) {
YFS_MODE = 1
}(me)
[5/10/2010 4:30:51 PM] jan.veverka: ?
[5/10/2010 4:31:00 PM] Frank Siegert: CSS_EW_SCHEME = {0,1} will turn
the EW PS off/on
ME_QED = {On,Off} will turn YFS on/off
[5/10/2010 4:31:21 PM] Frank Siegert: ME_QED that is
[5/10/2010 4:31:29 PM] Frank Siegert: ah, sorry, didn't see the underscore
[5/10/2010 4:31:30 PM] jan.veverka: ok
[5/10/2010 4:33:06 PM] jan.veverka: so by default
CSS_EW_SCHEME = 0
ME_QED = On
?
[5/10/2010 4:33:13 PM] Frank Siegert: yep
...
[5/10/2010 4:34:51 PM] Frank Siegert: sorry
[5/10/2010 4:34:57 PM] Frank Siegert: this has to be CSS_EW_MODE
[5/10/2010 4:35:30 PM] Frank Siegert: (like in my run card above)
..

